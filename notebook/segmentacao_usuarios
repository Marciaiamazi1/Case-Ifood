# ğŸ’¡ Exemplo de segmentaÃ§Ã£o: por ticket mÃ©dio
tickets = df.groupby('customer_id')['order_total_amount'].mean().reset_index()
tickets.columns = ['customer_id', 'ticket_medio']

# ğŸ“Œ Definindo faixas
tickets['segmento'] = pd.qcut(tickets['ticket_medio'], q=3, labels=['baixo', 'mÃ©dio', 'alto'])

# ğŸ”„ Juntando com ab_ref
segmentado = tickets.merge(ab_ref, on='customer_id')

# ğŸ“ˆ AnÃ¡lise de retenÃ§Ã£o por segmento
segmentado['repetiu'] = segmentado['customer_id'].isin(df[df['repetiu'] == True]['customer_id'])
print(segmentado.groupby(['segmento', 'is_target'])['repetiu'].mean())
